<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PadaONE Security</title>
    
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/flowcharts.css">
</head>
<body>
    <div class="app-container">
        
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo-area">
                    <div class="logo-box"><i class="ph ph-shield-check"></i></div>
                    <span style="font-weight: 600; color: #fff;">PadaONE Security</span>
                </div>
            </div>

            <nav>
                <div class="nav-group">
                    <div class="nav-title">Geral</div>
                    <div class="nav-item active" onclick="nav.switchTool('dashboard')">
                        <i class="ph ph-squares-four"></i> Dashboard
                    </div>
                    <div class="nav-item" onclick="nav.switchTool('logic')">
                        <i class="ph ph-tree-structure"></i> Lógica de Bibliotecas
                    </div>
                </div>

                <div class="nav-group">
                    <div class="nav-title">Ferramentas</div>
                    <div class="nav-item" onclick="nav.switchTool('trivy')">
                        <i class="ph ph-package"></i> Trivy (SCA)
                    </div>
                    <div class="nav-item" onclick="nav.switchTool('semgrep')">
                        <i class="ph ph-code"></i> Semgrep (SAST)
                    </div>
                    <div class="nav-item" onclick="nav.switchTool('gitleaks')">
                        <i class="ph ph-key"></i> Gitleaks (Secrets)
                    </div>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <header class="top-bar">
                <button id="btn-back" class="back-btn" onclick="nav.goBack()">
                    <i class="ph ph-caret-left"></i>
                </button>
                <span id="breadcrumb" style="color: var(--text-muted); font-size: 0.9rem;">DevSecOps > Dashboard</span>
            </header>

            <div id="view-dashboard" class="tool-layout">
                <div class="scroll-area">
                    <div class="badge-group">
                        <span class="badge recommend">PIPELINE</span>
                        <span class="badge">DEVSECOPS</span>
                        <span class="badge">VISUALIZAÇÃO INTERATIVA</span>
                    </div>
                    <h1>Pipeline DevSecOps Completo</h1>
                    <p>Fluxo integrado de segurança em 3 fases: Estação de Trabalho, Pipeline CI/CD e Auditoria Manual. O diagrama abaixo representa todo o ciclo de vida de segurança do desenvolvimento até a produção.</p>

                    <div style="background: linear-gradient(90deg, var(--primary-blue) 0%, var(--accent-cyan) 100%); height: 2px; width: 100px; margin: 30px 0;"></div>

                    <div class="diagram-container">
                        <img src="assets/images/Fluxograma-Seguranca.svg" alt="Pipeline DevSecOps Completo" class="diagram-svg">
                    </div>

                    <div class="meta-grid" style="grid-template-columns: repeat(2, 1fr); gap: 20px; margin: 40px 0;">
                        <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); padding: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <i class="ph ph-info" style="font-size: 1.5rem; color: var(--primary-blue);"></i>
                                <strong style="color: var(--primary-blue); font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px;">Sobre o Diagrama</strong>
                            </div>
                            <p style="margin: 0; font-size: 0.9rem; color: var(--text-muted); line-height: 1.6;">
                                O pipeline representa o fluxo completo de segurança, desde a configuração do ambiente até o sign-off final. Linhas sólidas indicam fluxo principal, linhas tracejadas indicam falhas e loops de feedback.
                            </p>
                        </div>
                        <div style="background: rgba(34, 139, 230, 0.1); border: 1px solid rgba(34, 139, 230, 0.3); padding: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <i class="ph ph-lightbulb" style="font-size: 1.5rem; color: var(--accent-cyan);"></i>
                                <strong style="color: var(--accent-cyan); font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px;">Navegação Rápida</strong>
                            </div>
                            <p style="margin: 0; font-size: 0.9rem; color: var(--text-muted); line-height: 1.6;">
                                Use o menu lateral ou os cards abaixo para acessar a documentação completa de cada ferramenta do pipeline DevSecOps.
                            </p>
                        </div>
                    </div>

                    <h3 style="margin: 50px 0 20px 0; color: var(--text-main); font-size: 1rem; text-transform: uppercase; letter-spacing: 1px;">
                        <i class="ph ph-shield-check" style="margin-right: 10px; color: var(--primary-blue);"></i>Ferramentas Principais
                    </h3>
                    <div class="meta-grid" style="grid-template-columns: repeat(3, 1fr); margin: 0 0 40px 0;">
                        <div class="meta-card clickable" onclick="nav.switchTool('trivy')">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                <i class="ph ph-package" style="font-size: 2rem; color: var(--primary-blue);"></i>
                                <span class="meta-label" style="color: var(--primary-blue); margin: 0;">TRIVY (SCA)</span>
                            </div>
                            <p style="margin: 0; font-size: 0.85rem; color: var(--text-muted); line-height: 1.5;">Software Composition Analysis e scan de vulnerabilidades</p>
                            <div style="margin-top: 12px; font-size: 0.75rem; color: var(--primary-blue); text-transform: uppercase; letter-spacing: 1px;">
                                Ver Documentação →
                            </div>
                        </div>
                        <div class="meta-card clickable" onclick="nav.switchTool('semgrep')">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                <i class="ph ph-code" style="font-size: 2rem; color: var(--accent-cyan);"></i>
                                <span class="meta-label" style="color: var(--accent-cyan); margin: 0;">SEMGREP (SAST)</span>
                            </div>
                            <p style="margin: 0; font-size: 0.85rem; color: var(--text-muted); line-height: 1.5;">Análise estática de código e detecção de padrões inseguros</p>
                            <div style="margin-top: 12px; font-size: 0.75rem; color: var(--accent-cyan); text-transform: uppercase; letter-spacing: 1px;">
                                Ver Documentação →
                            </div>
                        </div>
                        <div class="meta-card clickable" onclick="nav.switchTool('gitleaks')">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                <i class="ph ph-key" style="font-size: 2rem; color: var(--accent-gold);"></i>
                                <span class="meta-label" style="color: var(--accent-gold); margin: 0;">GITLEAKS (SECRETS)</span>
                            </div>
                            <p style="margin: 0; font-size: 0.85rem; color: var(--text-muted); line-height: 1.5;">Detecção de credenciais e secrets comprometidos no código</p>
                            <div style="margin-top: 12px; font-size: 0.75rem; color: var(--accent-gold); text-transform: uppercase; letter-spacing: 1px;">
                                Ver Documentação →
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 60px; padding-top: 40px; border-top: 1px solid var(--border-subtle);">
                        <h3 style="margin-bottom: 30px; color: var(--text-main); font-size: 1rem; text-transform: uppercase; letter-spacing: 1px;">
                            <i class="ph ph-list-numbers" style="margin-right: 10px; color: var(--primary-blue);"></i>Fases do Pipeline
                        </h3>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div style="background: rgba(132, 94, 247, 0.05); border-left: 3px solid #845EF7; padding: 20px;">
                                <div style="font-weight: 700; color: #845EF7; margin-bottom: 10px; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px;">
                                    Fase 1: Estação de Trabalho
                                </div>
                                <p style="margin: 0; font-size: 0.85rem; color: var(--text-muted); line-height: 1.6;">
                                    Configuração do ambiente, análise de bibliotecas e execução de ferramentas de segurança locais antes do commit.
                                </p>
                            </div>
                            <div style="background: rgba(239, 68, 68, 0.05); border-left: 3px solid #EF4444; padding: 20px;">
                                <div style="font-weight: 700; color: #EF4444; margin-bottom: 10px; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px;">
                                    Fase 2: Pipeline CI/CD
                                </div>
                                <p style="margin: 0; font-size: 0.85rem; color: var(--text-muted); line-height: 1.6;">
                                    Revalidação automática paralela, DAST, geração de SBOM e monitoramento contínuo no pipeline de integração.
                                </p>
                            </div>
                            <div style="background: rgba(64, 192, 87, 0.05); border-left: 3px solid #40C057; padding: 20px;">
                                <div style="font-weight: 700; color: #40C057; margin-bottom: 10px; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px;">
                                    Fase 3: Auditoria Manual
                                </div>
                                <p style="margin: 0; font-size: 0.85rem; color: var(--text-muted); line-height: 1.6;">
                                    Triagem de escopo, pentest com Burp Suite, coleta de evidências e geração de relatório final com sign-off.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="view-logic" class="tool-layout hidden">
                <div class="scroll-area">
                    <div class="badge-group">
                        <span class="badge recommend">GOVERNANÇA</span>
                        <span class="badge">SCA</span>
                        <span class="badge">MANUAL V1.0</span>
                    </div>
                    <h1>Lógica de Bibliotecas</h1>
                    <p>Este fluxo fornece as diretrizes para que o desenvolvedor decida, de forma autônoma, entre a correção imediata de uma biblioteca, sua substituição ou o aceite de riscos residuais. O objetivo é proteger a Supply Chain.</p>

                    <section id="logic-quick" style="margin-bottom: 50px;">
                        <h3>1. Tabela de Decisão Rápida</h3>
                        <p>Utilize esta tabela como filtro inicial ao identificar uma vulnerabilidade no Trivy ou deps.dev.</p>
                        
                        <div class="cvss-table">
                            <div class="cvss-row cvss-header">
                                <span class="col-label">SEVERIDADE</span>
                                <span class="col-label">PLANO DE AÇÃO IMEDIATO</span>
                                <span class="col-label" style="text-align: center;">WAIVER</span>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--status-critical); font-weight: 700;">ALTA/CRÍTICA (7.0+)</span>
                                <span style="font-size: 0.9rem; color: #fff;">Bloqueio imediato ou update obrigatório se for alcançável.</span>
                                <div class="badge-full" style="border-color: var(--status-critical); color: var(--status-critical);">RESTRITO</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--status-success); font-weight: 700;">MÉDIA/BAIXA (<6.9)</span>
                                <span style="font-size: 0.9rem; color: #fff;">Update se houver versão estável; caso contrário, monitorar.</span>
                                <div class="badge-full" style="border-color: var(--status-success); color: var(--status-success);">PERMITIDO</div>
                            </div>
                        </div>
                    </section>

                    <section id="logic-cvss" style="margin-bottom: 50px;">
                        <h3>2. Entenda a Métrica CVSS v4.0</h3>
                        <p>A pontuação define a autonomia do desenvolvedor.</p>
                        
                        <div class="meta-grid" style="grid-template-columns: repeat(3, 1fr);">
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">COMPOSIÇÃO</span>
                                <p style="margin: 0; font-size: 0.8rem; color: #fff;">Base, Ameaça, Ambiental e Suplementar.</p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">STRING VETORIAL</span>
                                <p style="margin: 0; font-size: 0.8rem; color: #fff;">Ex: <code>CVSS:4.0/AV:N...</code></p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">GATILHO</span>
                                <p style="margin: 0; font-size: 0.8rem; color: #fff;">Nota 9.0+ exige revisão Sênior.</p>
                            </div>
                        </div>

                        <div class="cvss-table">
                            <div class="cvss-row cvss-header">
                                <span class="col-label">PONTUAÇÃO</span>
                                <span class="col-label">AÇÃO DE GOVERNANÇA</span>
                                <span class="col-label" style="text-align: center;">AUTONOMIA</span>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--status-critical); font-weight: 700;">9.0 - 10.0</span>
                                <span style="font-size: 0.9rem; color: #fff;">Escalonamento Crítico Obrigatório.</span>
                                <div class="badge-full" style="border-color: var(--status-critical); color: var(--status-critical);">NENHUMA</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--accent-gold); font-weight: 700;">7.0 - 8.9</span>
                                <span style="font-size: 0.9rem; color: #fff;">Waiver exige busca comprovada de alternativas.</span>
                                <div class="badge-full" style="border-color: var(--accent-gold); color: var(--accent-gold);">RESTRITA</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--status-success); font-weight: 700;">0.0 - 6.9</span>
                                <span style="font-size: 0.9rem; color: #fff;">Waiver permitido se Esforço > 16h.</span>
                                <div class="badge-full" style="border-color: var(--status-success); color: var(--status-success);">TOTAL</div>
                            </div>
                        </div>
                    </section>

                    <section id="logic-context" style="margin-bottom: 50px;">
                        <h3>3. Diferenciação de Contexto</h3>
                        <p>O rigor da análise depende da natureza da dependência.</p>
                        <div class="meta-grid" style="grid-template-columns: 1fr 1fr;">
                            <div class="meta-card card-critical">
                                <span class="meta-label" style="color: var(--status-critical);">DEPENDENCIES (PRODUÇÃO)</span>
                                <p style="margin: 0; font-size: 0.85rem; color: #fff;">Rigor Máximo.</p>
                            </div>
                            <div class="meta-card card-warning">
                                <span class="meta-label" style="color: var(--accent-gold);">DEVDEPENDENCIES (BUILD)</span>
                                <p style="margin: 0; font-size: 0.85rem; color: #fff;">Foco em Supply Chain.</p>
                            </div>
                        </div>
                    </section>

                    <section id="logic-steps" style="margin-bottom: 50px;">
                        <h3>4. Fluxo de Decisão e Triagem</h3>
                        
                        <h4 style="color: var(--accent-cyan); margin-bottom: 10px;">PASSO 1: IDENTIFICAÇÃO</h4>
                        <p style="font-size: 0.9rem;">Identifique a vulnerabilidade via Trivy ou deps.dev.</p>
                        <img src="assets/images/deps-dev.png" class="manual-img" style="max-width: 100%;" alt="Relatório Trivy">
                        
                        <h4 style="color: var(--accent-cyan); margin-bottom: 10px;">PASSO 2: TRIAGEM INTERATIVA</h4>
                        <div id="flowchart-sca" class="flowchart-container" style="margin-bottom: 30px;"></div>

                        <h4 style="color: var(--accent-cyan); margin-bottom: 10px;">PASSO 3: BUSCA POR ALTERNATIVAS</h4>
                        <p style="font-size: 0.9rem;">Se a correção for inviável, busque alternativas no Snyk Advisor.</p>
                        <img src="assets/images/snyk-advisor.png" class="manual-img" style="max-width: 500px; margin: 20px auto;" alt="Snyk Advisor">
                    </section>

                    <section id="logic-calc" style="margin-bottom: 50px;">
                        <h3>5. Avaliação de Esforço (Regra das 16h)</h3>
                        <p>O esforço total (E = Ta + Ti + Tv) contempla todo o ciclo.</p>
                        
                        <div class="pro-tip">
                            <div class="pro-tip-header"><i class="ph ph-function"></i> Regra das 16 Horas</div>
                            <p style="margin: 0; font-size: 0.9rem;">Se a correção custar menos de 16h, ela é <strong>OBRIGATÓRIA</strong>.</p>
                        </div>

                        <div style="background: var(--bg-panel); padding: 24px; border: 1px solid var(--border-subtle);">
                            <div class="form-grid">
                                <div>
                                    <label>TEMPO ANÁLISE (Ta)</label>
                                    <input type="number" id="time-analysis" placeholder="Horas">
                                </div>
                                <div>
                                    <label>TEMPO IMPLEMENTAÇÃO (Ti)</label>
                                    <input type="number" id="time-implementation" placeholder="Horas">
                                </div>
                                <div>
                                    <label>TEMPO VALIDAÇÃO (Tv)</label>
                                    <input type="number" id="time-validation" placeholder="Horas">
                                </div>
                            </div>
                            <button class="action-btn" onclick="calculators.calculateEffort()">Calcular Elegibilidade</button>
                            <div id="effort-result" class="result-box hidden"></div>
                        </div>
                    </section>

                    <section id="logic-waiver" style="margin-bottom: 50px;">
                        <h3>6. Gestão de Waivers e Templates</h3>
                        <h4 style="margin-top: 30px; font-size: 0.9rem; color: #fff;">NO GIT (MENSAGEM DE COMMIT)</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Template</span>
                                <button class="btn-copy" onclick="utils.copyCode('waiver-git')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="waiver-git">Waiver de Segurança: [CVE-ID]
Justificativa: [Motivo Técnico]
Status: Função isolada.
Prazo: 10 dias.</code></pre>
                        </div>

                        <h4 style="margin-top: 30px; font-size: 0.9rem; color: #fff;">NO OPENPROJECT</h4>
                        <img src="assets/images/open-project.png" class="manual-img" style="max-width: 600px; margin: 20px auto;" alt="OpenProject">
                    </section>

                    <section id="logic-escalation" style="margin-bottom: 50px;">
                        <h3>7. Escalonamento Crítico</h3>
                        <div class="meta-card card-critical">
                            <span class="meta-label" style="color: var(--status-critical);">PROCEDIMENTO (CVSS > 9.0)</span>
                            <ul style="margin: 10px 0 0 20px; color: #fff; font-size: 0.9rem;">
                                <li>Alterar status para <strong>[Em Revisão]</strong>.</li>
                                <li>Solicitar revisão de Sênior/Sec.</li>
                                <li>Aguardar "De Acordo" no ticket.</li>
                            </ul>
                        </div>
                    </section>
                </div>

                <aside class="right-toc">
                    <div class="toc-header">Nesta Página</div>
                    <ul class="toc-list">
                        <li class="toc-item"><a href="#logic-quick">Decisão Rápida</a></li>
                        <li class="toc-item"><a href="#logic-cvss">Métrica CVSS</a></li>
                        <li class="toc-item"><a href="#logic-context">Contexto</a></li>
                        <li class="toc-item"><a href="#logic-steps">Fluxo e Triagem</a></li>
                        <li class="toc-item"><a href="#logic-calc">Calculadora</a></li>
                        <li class="toc-item"><a href="#logic-waiver">Templates Waiver</a></li>
                        <li class="toc-item"><a href="#logic-escalation">Escalonamento</a></li>
                    </ul>
                </aside>
            </div>

            <div id="view-trivy" class="tool-layout hidden">
                <div class="scroll-area">
                    <div class="badge-group">
                        <span class="badge recommend">SCA</span>
                        <span class="badge">TRIVY</span>
                        <span class="badge">MANUAL V1.0</span>
                    </div>
                    <h1>Trivy - Software Composition Analysis</h1>
                    <p>O Trivy é uma ferramenta SCA (Software Composition Analysis) que identifica vulnerabilidades em dependências, imagens de container, sistemas operacionais e arquivos de configuração (IaC). É essencial para garantir a segurança da Supply Chain.</p>

                    <section style="margin-bottom: 50px;">
                        <h3>1. Visão Geral</h3>
                        <div class="meta-grid" style="grid-template-columns: repeat(4, 1fr);">
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">TIPO</span>
                                <p style="margin: 0; font-size: 0.85rem; color: #fff;">SCA + Container Scan</p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">LINGUAGENS</span>
                                <p style="margin: 0; font-size: 0.85rem; color: #fff;">20+ (JS, Python, Java, Go, etc.)</p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">ALVOS</span>
                                <p style="margin: 0; font-size: 0.85rem; color: #fff;">Code, Images, IaC, SBOM</p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">EXECUÇÃO</span>
                                <p style="margin: 0; font-size: 0.85rem; color: #fff;">Local + Pipeline + Registry</p>
                            </div>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>2. Instalação e Configuração</h3>
                        
                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">INSTALAÇÃO (WINDOWS)</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>PowerShell</span>
                                <button class="btn-copy" onclick="utils.copyCode('trivy-install-win')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="trivy-install-win"># Via Chocolatey
choco install trivy

# Verificar instalação
trivy --version

# Atualizar banco de vulnerabilidades
trivy image --download-db-only</code></pre>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">INSTALAÇÃO (LINUX/MAC)</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Bash</span>
                                <button class="btn-copy" onclick="utils.copyCode('trivy-install-linux')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="trivy-install-linux"># Via script de instalação
curl -sfL https://raw.githubusercontent.com/aquasecurity/trivy/main/contrib/install.sh | sh -s -- -b /usr/local/bin

# Via Homebrew (Mac)
brew install trivy

# Via apt (Debian/Ubuntu)
sudo apt-get install wget apt-transport-https gnupg lsb-release
wget -qO - https://aquasecurity.github.io/trivy-repo/deb/public.key | sudo apt-key add -
echo "deb https://aquasecurity.github.io/trivy-repo/deb $(lsb_release -sc) main" | sudo tee -a /etc/apt/sources.list.d/trivy.list
sudo apt-get update
sudo apt-get install trivy</code></pre>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>3. Scan de Dependências (Repositório)</h3>
                        
                        <div class="pro-tip">
                            <div class="pro-tip-header"><i class="ph ph-package"></i> Supply Chain Security</div>
                            <p style="margin: 0; font-size: 0.9rem;">Execute o Trivy <strong>antes de adicionar novas dependências</strong> ao projeto para garantir que não introduzem vulnerabilidades conhecidas.</p>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">SCAN BÁSICO DE PROJETO</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Terminal</span>
                                <button class="btn-copy" onclick="utils.copyCode('trivy-fs-basic')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="trivy-fs-basic"># Scan do diretório atual (detecta package.json, requirements.txt, etc.)
trivy fs .

# Scan apenas vulnerabilidades CRITICAL e HIGH
trivy fs --severity CRITICAL,HIGH .

# Scan com saída em JSON
trivy fs --format json --output trivy-report.json .

# Scan com saída em SARIF (GitHub Advanced Security)
trivy fs --format sarif --output trivy-report.sarif .</code></pre>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">SCAN POR TIPO DE ARQUIVO</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Terminal</span>
                                <button class="btn-copy" onclick="utils.copyCode('trivy-scanners')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="trivy-scanners"># Apenas vulnerabilidades de dependências
trivy fs --scanners vuln .

# Vulnerabilidades + Misconfigurações (IaC)
trivy fs --scanners vuln,config .

# Vulnerabilidades + Secrets
trivy fs --scanners vuln,secret .

# Tudo (vuln, config, secret, license)
trivy fs --scanners vuln,config,secret,license .</code></pre>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>4. Scan de Imagens Docker</h3>
                        
                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">SCAN DE IMAGENS LOCAIS</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Terminal</span>
                                <button class="btn-copy" onclick="utils.copyCode('trivy-image')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="trivy-image"># Scan de imagem local
trivy image node:18-alpine

# Scan de imagem com severidade específica
trivy image --severity CRITICAL,HIGH nginx:latest

# Scan apenas SO (ignorar dependências de app)
trivy image --scanners vuln --vuln-type os ubuntu:22.04

# Scan com relatório detalhado
trivy image --format json --output nginx-report.json nginx:latest</code></pre>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">SCAN DE REGISTRY REMOTO</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Terminal</span>
                                <button class="btn-copy" onclick="utils.copyCode('trivy-registry')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="trivy-registry"># Scan de imagem no Docker Hub
trivy image library/python:3.11-slim

# Scan em registry privado (com autenticação)
trivy image --username $REGISTRY_USER --password $REGISTRY_PASS \
  registry.exemplo.com/app:latest

# Scan de imagem no Amazon ECR
trivy image --region us-east-1 \
  123456789.dkr.ecr.us-east-1.amazonaws.com/app:latest</code></pre>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>5. Integração CI/CD (Pipeline)</h3>
                        
                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">GITHUB ACTIONS</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>.github/workflows/trivy.yml</span>
                                <button class="btn-copy" onclick="utils.copyCode('trivy-github')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="trivy-github">name: Trivy SCA

on: [push, pull_request]

jobs:
  trivy-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Run Trivy filesystem scan
        uses: aquasecurity/trivy-action@master
        with:
          scan-type: 'fs'
          scan-ref: '.'
          severity: 'CRITICAL,HIGH'
          exit-code: '1'
          format: 'sarif'
          output: 'trivy-results.sarif'
      
      - name: Upload SARIF to GitHub Security
        uses: github/codeql-action/upload-sarif@v2
        with:
          sarif_file: 'trivy-results.sarif'
        if: always()</code></pre>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">GITLAB CI</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>.gitlab-ci.yml</span>
                                <button class="btn-copy" onclick="utils.copyCode('trivy-gitlab')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="trivy-gitlab">trivy-scan:
  stage: security
  image: aquasec/trivy:latest
  script:
    - trivy fs --exit-code 1 --severity CRITICAL,HIGH --format json --output trivy-report.json .
  artifacts:
    reports:
      dependency_scanning: trivy-report.json
    when: always
  allow_failure: false</code></pre>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">DOCKER BUILD COM SCAN</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Pipeline Script</span>
                                <button class="btn-copy" onclick="utils.copyCode('trivy-docker')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="trivy-docker">#!/bin/bash
# Build e scan de imagem Docker

IMAGE_NAME="myapp:latest"

# Build da imagem
docker build -t $IMAGE_NAME .

# Scan da imagem com Trivy
trivy image --exit-code 1 --severity CRITICAL,HIGH $IMAGE_NAME

# Se passou no scan, fazer push
if [ $? -eq 0 ]; then
    echo "✅ Imagem aprovada no scan de segurança"
    docker push $IMAGE_NAME
else
    echo "❌ Imagem bloqueada por vulnerabilidades"
    exit 1
fi</code></pre>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>6. Tratamento de Vulnerabilidades</h3>
                        
                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">ARQUIVO .trivyignore</h4>
                        <p>Use para suprimir vulnerabilidades aceitas (com justificativa documentada).</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span>.trivyignore</span>
                                <button class="btn-copy" onclick="utils.copyCode('trivy-ignore')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="trivy-ignore"># CVE-YYYY-XXXXX: Descrição do motivo da exceção
# Justificativa: Não exploitável no contexto de uso atual
CVE-2023-12345

# CVE com data de expiração (formato: até YYYY-MM-DD)
CVE-2023-67890 # exp:2024-12-31

# Ignorar família de CVEs
CVE-2023-*

# Comentários e documentação
# Ticket de rastreamento: JIRA-1234
# Aprovado por: Security Lead
# Data: 2024-01-15</code></pre>
                        </div>

                        <div class="meta-card card-warning" style="margin-top: 30px;">
                            <span class="meta-label" style="color: var(--accent-gold);">⚠️ ATENÇÃO - WAIVERS</span>
                            <p style="margin: 0; font-size: 0.85rem; color: #fff;">Toda exceção no <code>.trivyignore</code> deve ter justificativa documentada e aprovação do Security Lead. Revisar periodicamente.</p>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>7. Critérios de Severidade CVSS</h3>
                        
                        <div class="cvss-table">
                            <div class="cvss-row cvss-header">
                                <span class="col-label">SEVERIDADE</span>
                                <span class="col-label">AÇÃO IMEDIATA</span>
                                <span class="col-label" style="text-align: center;">WAIVER</span>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--status-critical); font-weight: 700;">CRITICAL (9.0+)</span>
                                <span style="font-size: 0.9rem; color: #fff;">Bloqueio obrigatório. Escalonamento para Sênior.</span>
                                <div class="badge-full" style="border-color: var(--status-critical); color: var(--status-critical);">PROIBIDO</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--accent-gold); font-weight: 700;">HIGH (7.0-8.9)</span>
                                <span style="font-size: 0.9rem; color: #fff;">Update obrigatório ou waiver justificado.</span>
                                <div class="badge-full" style="border-color: var(--accent-gold); color: var(--accent-gold);">RESTRITO</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--primary-blue); font-weight: 700;">MEDIUM (4.0-6.9)</span>
                                <span style="font-size: 0.9rem; color: #fff;">Correção recomendada. Waiver se esforço > 16h.</span>
                                <div class="badge-full" style="border-color: var(--primary-blue); color: var(--primary-blue);">PERMITIDO</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--status-success); font-weight: 700;">LOW (0.1-3.9)</span>
                                <span style="font-size: 0.9rem; color: #fff;">Monitorar. Correção não urgente.</span>
                                <div class="badge-full" style="border-color: var(--status-success); color: var(--status-success);">PERMITIDO</div>
                            </div>
                        </div>

                        <div class="pro-tip" style="margin-top: 30px;">
                            <div class="pro-tip-header"><i class="ph ph-link"></i> Lógica de Bibliotecas</div>
                            <p style="margin: 0; font-size: 0.9rem;">Para decisões detalhadas sobre como tratar vulnerabilidades, consulte a <a href="#" onclick="nav.switchTool('logic'); return false;" style="color: var(--accent-cyan); text-decoration: underline;">Lógica de Bibliotecas</a>.</p>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>8. Tipos de Scan Avançados</h3>
                        
                        <div class="meta-grid" style="grid-template-columns: 1fr 1fr;">
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">SBOM GENERATION</span>
                                <p style="margin: 5px 0 10px 0; font-size: 0.85rem; color: #fff;">Gerar Software Bill of Materials</p>
                                <div class="code-block" style="margin: 0;">
                                    <pre style="padding: 15px;"><code>trivy sbom --format cyclonedx \
  --output sbom.json \
  myapp:latest</code></pre>
                                </div>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">IAC SCAN (TERRAFORM)</span>
                                <p style="margin: 5px 0 10px 0; font-size: 0.85rem; color: #fff;">Scan de misconfigurations IaC</p>
                                <div class="code-block" style="margin: 0;">
                                    <pre style="padding: 15px;"><code>trivy config \
  --severity CRITICAL,HIGH \
  ./terraform/</code></pre>
                                </div>
                            </div>
                        </div>

                        <div class="meta-grid" style="grid-template-columns: 1fr 1fr; margin-top: 20px;">
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">KUBERNETES MANIFESTS</span>
                                <p style="margin: 5px 0 10px 0; font-size: 0.85rem; color: #fff;">Scan de YAML do K8s</p>
                                <div class="code-block" style="margin: 0;">
                                    <pre style="padding: 15px;"><code>trivy config \
  --scanners misconfig \
  k8s/deployment.yaml</code></pre>
                                </div>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">ROOTFS SCAN</span>
                                <p style="margin: 5px 0 10px 0; font-size: 0.85rem; color: #fff;">Scan de filesystem de container</p>
                                <div class="code-block" style="margin: 0;">
                                    <pre style="padding: 15px;"><code>trivy rootfs \
  --security-checks vuln \
  /path/to/rootfs</code></pre>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>9. Integração com deps.dev</h3>
                        
                        <p>O deps.dev do Google complementa o Trivy com análise de reachability e OpenSSF Scorecard.</p>

                        <div class="meta-grid" style="grid-template-columns: 1fr 1fr;">
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--primary-blue);">TRIVY</span>
                                <ul style="margin: 10px 0 0 20px; color: #fff; font-size: 0.85rem; line-height: 1.6;">
                                    <li>Vulnerabilidades conhecidas (CVE)</li>
                                    <li>Scan de imagens Docker</li>
                                    <li>Automação CI/CD</li>
                                    <li>Offline-capable</li>
                                </ul>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">DEPS.DEV</span>
                                <ul style="margin: 10px 0 0 20px; color: #fff; font-size: 0.85rem; line-height: 1.6;">
                                    <li>Análise de alcançabilidade</li>
                                    <li>OpenSSF Scorecard</li>
                                    <li>Grafo de dependências</li>
                                    <li>Web-based UI</li>
                                </ul>
                            </div>
                        </div>

                        <div class="pro-tip" style="margin-top: 30px;">
                            <div class="pro-tip-header"><i class="ph ph-arrows-merge"></i> Fluxo Recomendado</div>
                            <p style="margin: 0; font-size: 0.9rem;"><strong>1.</strong> Trivy (local/pipeline) detecta CVE → <strong>2.</strong> deps.dev valida se é exploitável → <strong>3.</strong> Lógica de Bibliotecas define ação.</p>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>10. Boas Práticas de Implementação</h3>
                        
                        <div class="meta-card card-critical">
                            <span class="meta-label" style="color: var(--status-success);">CHECKLIST TRIVY</span>
                            <ul style="margin: 10px 0 0 20px; color: #fff; font-size: 0.9rem; line-height: 1.8;">
                                <li><strong>Local:</strong> Executar <code>trivy fs .</code> antes de commits com novas dependências.</li>
                                <li><strong>Pre-commit Hook:</strong> Bloquear commits com CRITICAL/HIGH vulnerabilities.</li>
                                <li><strong>Pipeline:</strong> Gate obrigatório no CI/CD com <code>--exit-code 1</code>.</li>
                                <li><strong>Imagens:</strong> Scan de todas as imagens antes de push para registry.</li>
                                <li><strong>Base Images:</strong> Preferir imagens slim/alpine com menos vulnerabilidades.</li>
                                <li><strong>DB Updates:</strong> Atualizar banco de vulnerabilidades diariamente.</li>
                                <li><strong>SARIF Upload:</strong> Integrar com GitHub/GitLab Security Dashboards.</li>
                                <li><strong>Waivers:</strong> Documentar todas as exceções no <code>.trivyignore</code> com justificativa.</li>
                            </ul>
                        </div>
                    </section>
                </div>
            </div>
            <div id="view-semgrep" class="tool-layout hidden">
                <div class="scroll-area">
                    <div class="badge-group">
                        <span class="badge recommend">SAST</span>
                        <span class="badge">SEMGREP</span>
                        <span class="badge">MANUAL V1.0</span>
                    </div>
                    <h1>Semgrep - Análise Estática de Código</h1>
                    <p>O Semgrep é uma ferramenta SAST (Static Application Security Testing) que identifica vulnerabilidades, bugs e padrões de código inseguro através de regras customizáveis. Suporta múltiplas linguagens e executa tanto localmente quanto no pipeline.</p>

                    <section style="margin-bottom: 50px;">
                        <h3>1. Visão Geral</h3>
                        <div class="meta-grid" style="grid-template-columns: repeat(3, 1fr);">
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">TIPO</span>
                                <p style="margin: 0; font-size: 0.85rem; color: #fff;">SAST (Static Analysis)</p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">LINGUAGENS</span>
                                <p style="margin: 0; font-size: 0.85rem; color: #fff;">30+ (JS, Python, Java, Go, etc.)</p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">EXECUÇÃO</span>
                                <p style="margin: 0; font-size: 0.85rem; color: #fff;">Local + Pipeline + IDE</p>
                            </div>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>2. Instalação e Configuração</h3>
                        
                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">INSTALAÇÃO (PYTHON/PIP)</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Terminal</span>
                                <button class="btn-copy" onclick="utils.copyCode('semgrep-install')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="semgrep-install"># Via pip (recomendado)
pip install semgrep

# Verificar instalação
semgrep --version

# Atualizar para última versão
pip install --upgrade semgrep</code></pre>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">INSTALAÇÃO (DOCKER)</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Docker</span>
                                <button class="btn-copy" onclick="utils.copyCode('semgrep-docker')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="semgrep-docker"># Pull da imagem oficial
docker pull returntocorp/semgrep

# Executar scan
docker run --rm -v "${PWD}:/src" returntocorp/semgrep semgrep --config=auto /src</code></pre>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>3. Execução Local (Desenvolvimento)</h3>
                        
                        <div class="pro-tip">
                            <div class="pro-tip-header"><i class="ph ph-code"></i> Boa Prática</div>
                            <p style="margin: 0; font-size: 0.9rem;">Execute o Semgrep <strong>antes de cada commit</strong> ou integre ao seu IDE para feedback instantâneo sobre vulnerabilidades no código.</p>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">SCAN BÁSICO</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Terminal</span>
                                <button class="btn-copy" onclick="utils.copyCode('semgrep-basic')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="semgrep-basic"># Scan com regras automáticas (recomendado)
semgrep --config=auto .

# Scan apenas vulnerabilidades de segurança
semgrep --config=p/security-audit .

# Scan específico para linguagem (ex: JavaScript)
semgrep --config=p/javascript .

# Scan com saída em JSON
semgrep --config=auto --json --output=semgrep-report.json .</code></pre>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">RULESETS RECOMENDADOS</h4>
                        <div class="cvss-table">
                            <div class="cvss-row cvss-header">
                                <span class="col-label">RULESET</span>
                                <span class="col-label">DESCRIÇÃO</span>
                                <span class="col-label" style="text-align: center;">USO</span>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--status-critical); font-weight: 700;">p/security-audit</span>
                                <span style="font-size: 0.9rem; color: #fff;">Vulnerabilidades OWASP Top 10 e CWE.</span>
                                <div class="badge-full" style="border-color: var(--status-critical); color: var(--status-critical);">OBRIGATÓRIO</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--accent-gold); font-weight: 700;">p/owasp-top-ten</span>
                                <span style="font-size: 0.9rem; color: #fff;">Focado nas 10 vulnerabilidades mais críticas.</span>
                                <div class="badge-full" style="border-color: var(--accent-gold); color: var(--accent-gold);">RECOMENDADO</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--primary-blue); font-weight: 700;">p/r2c-best-practices</span>
                                <span style="font-size: 0.9rem; color: #fff;">Boas práticas de código e padrões.</span>
                                <div class="badge-full" style="border-color: var(--primary-blue); color: var(--primary-blue);">OPCIONAL</div>
                            </div>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">INTEGRAÇÃO COM GIT HOOKS</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>.git/hooks/pre-commit</span>
                                <button class="btn-copy" onclick="utils.copyCode('semgrep-hook')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="semgrep-hook">#!/bin/sh
# Pre-commit hook para Semgrep

echo "Running Semgrep SAST..."
semgrep --config=p/security-audit --error --quiet

if [ $? -ne 0 ]; then
    echo "⚠️  Semgrep detectou vulnerabilidades! Commit bloqueado."
    exit 1
fi

echo "✅ Semgrep: Nenhuma vulnerabilidade detectada."
exit 0</code></pre>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>4. Integração CI/CD (Pipeline)</h3>
                        
                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">GITHUB ACTIONS</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>.github/workflows/semgrep.yml</span>
                                <button class="btn-copy" onclick="utils.copyCode('semgrep-github')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="semgrep-github">name: Semgrep

on: [push, pull_request]

jobs:
  semgrep:
    name: SAST Scan
    runs-on: ubuntu-latest
    container:
      image: returntocorp/semgrep
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Run Semgrep
        run: semgrep scan --config=auto --error --sarif --output=semgrep.sarif .
      
      - name: Upload SARIF
        uses: github/codeql-action/upload-sarif@v2
        with:
          sarif_file: semgrep.sarif
        if: always()</code></pre>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">GITLAB CI</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>.gitlab-ci.yml</span>
                                <button class="btn-copy" onclick="utils.copyCode('semgrep-gitlab')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="semgrep-gitlab">semgrep:
  stage: security
  image: returntocorp/semgrep
  script:
    - semgrep --config=auto --json --output=semgrep-report.json .
  artifacts:
    reports:
      sast: semgrep-report.json
    when: always
  allow_failure: false</code></pre>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>5. Regras Customizadas</h3>
                        
                        <p>Crie regras específicas para padrões de segurança do seu projeto no arquivo <code>.semgrep.yml</code>.</p>

                        <div class="code-block">
                            <div class="code-header">
                                <span>.semgrep.yml</span>
                                <button class="btn-copy" onclick="utils.copyCode('semgrep-custom')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="semgrep-custom">rules:
  - id: hardcoded-secret
    pattern: |
      password = "..."
    message: Senha hardcoded detectada no código
    severity: ERROR
    languages: [python, javascript]
    
  - id: sql-injection
    pattern: |
      execute("SELECT * FROM users WHERE id = " + $VAR)
    message: Possível SQL Injection detectado
    severity: ERROR
    languages: [python, java]
    
  - id: eval-usage
    pattern: eval(...)
    message: Uso de eval() é inseguro
    severity: WARNING
    languages: [javascript, python]</code></pre>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>6. Tratamento de Resultados</h3>
                        
                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">SUPRESSÃO DE FALSOS POSITIVOS</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Código com Comentário</span>
                                <button class="btn-copy" onclick="utils.copyCode('semgrep-suppress')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="semgrep-suppress">// JavaScript/TypeScript
eval(userInput); // nosemgrep: eval-usage

# Python
password = "default123"  # nosemgrep: hardcoded-secret

/* Múltiplas linhas */
// nosemgrep
const query = "SELECT * FROM " + table;
// nosemgrep-end</code></pre>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">ARQUIVO .semgrepignore</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>.semgrepignore</span>
                                <button class="btn-copy" onclick="utils.copyCode('semgrep-ignore')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="semgrep-ignore"># Ignorar diretórios
node_modules/
dist/
build/
.venv/

# Ignorar arquivos de teste
**/test/**
**/*.test.js
**/*.spec.ts

# Arquivos gerados
**/*.min.js
**/*.bundle.js</code></pre>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>7. Categorização de Vulnerabilidades</h3>
                        
                        <div class="cvss-table">
                            <div class="cvss-row cvss-header">
                                <span class="col-label">SEVERIDADE</span>
                                <span class="col-label">AÇÃO IMEDIATA</span>
                                <span class="col-label" style="text-align: center;">PRAZO</span>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--status-critical); font-weight: 700;">ERROR (Crítico)</span>
                                <span style="font-size: 0.9rem; color: #fff;">Correção obrigatória antes do merge.</span>
                                <div class="badge-full" style="border-color: var(--status-critical); color: var(--status-critical);">IMEDIATO</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--accent-gold); font-weight: 700;">WARNING (Alto)</span>
                                <span style="font-size: 0.9rem; color: #fff;">Revisar e corrigir dentro do sprint.</span>
                                <div class="badge-full" style="border-color: var(--accent-gold); color: var(--accent-gold);">7 DIAS</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--primary-blue); font-weight: 700;">INFO (Baixo)</span>
                                <span style="font-size: 0.9rem; color: #fff;">Correção recomendada, não bloqueante.</span>
                                <div class="badge-full" style="border-color: var(--primary-blue); color: var(--primary-blue);">30 DIAS</div>
                            </div>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>8. Integração com IDE</h3>
                        
                        <div class="meta-grid" style="grid-template-columns: 1fr 1fr;">
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">VS CODE</span>
                                <p style="margin: 5px 0 10px 0; font-size: 0.85rem; color: #fff;">Extensão oficial: <strong>Semgrep</strong></p>
                                <div class="code-block" style="margin: 0;">
                                    <pre style="padding: 15px;"><code>ext install semgrep.semgrep</code></pre>
                                </div>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">INTELLIJ / PYCHARM</span>
                                <p style="margin: 5px 0 10px 0; font-size: 0.85rem; color: #fff;">Plugin disponível no Marketplace</p>
                                <div class="code-block" style="margin: 0;">
                                    <pre style="padding: 15px;"><code>Settings > Plugins > Semgrep</code></pre>
                                </div>
                            </div>
                        </div>

                        <div class="pro-tip" style="margin-top: 30px;">
                            <div class="pro-tip-header"><i class="ph ph-lightbulb"></i> Feedback em Tempo Real</div>
                            <p style="margin: 0; font-size: 0.9rem;">Com a extensão do IDE, o Semgrep sublinha vulnerabilidades enquanto você codifica, permitindo correção imediata.</p>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>9. Boas Práticas de Uso</h3>
                        
                        <div class="meta-card card-critical">
                            <span class="meta-label" style="color: var(--status-success);">CHECKLIST DE IMPLEMENTAÇÃO</span>
                            <ul style="margin: 10px 0 0 20px; color: #fff; font-size: 0.9rem; line-height: 1.8;">
                                <li><strong>Local:</strong> Integrar pre-commit hook para bloquear commits vulneráveis.</li>
                                <li><strong>IDE:</strong> Instalar extensão para feedback instantâneo.</li>
                                <li><strong>Pipeline:</strong> Executar no CI/CD com <code>--error</code> para bloquear builds.</li>
                                <li><strong>Regras:</strong> Começar com <code>p/security-audit</code> e adicionar custom rules.</li>
                                <li><strong>Baseline:</strong> Documentar falsos positivos no <code>.semgrepignore</code> ou com comentários.</li>
                                <li><strong>Monitoramento:</strong> Revisar relatórios semanalmente para novas vulnerabilidades.</li>
                            </ul>
                        </div>
                    </section>
                </div>
            </div>
            <div id="view-gitleaks" class="tool-layout hidden">
                <div class="scroll-area">
                    <div class="badge-group">
                        <span class="badge recommend">SECRETS DETECTION</span>
                        <span class="badge">GITLEAKS</span>
                        <span class="badge">MANUAL V1.0</span>
                    </div>
                    <h1>Gitleaks - Detecção de Credenciais</h1>
                    <p>O Gitleaks é uma ferramenta de detecção de secrets (credenciais, tokens, chaves de API) comprometidas no código-fonte e histórico do Git. A execução deve ocorrer tanto localmente quanto no pipeline CI/CD.</p>

                    <section style="margin-bottom: 50px;">
                        <h3>1. Visão Geral</h3>
                        <div class="meta-grid" style="grid-template-columns: repeat(3, 1fr);">
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">TIPO</span>
                                <p style="margin: 0; font-size: 0.85rem; color: #fff;">Secrets Detection</p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">LINGUAGEM</span>
                                <p style="margin: 0; font-size: 0.85rem; color: #fff;">Agnóstico (All)</p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">EXECUÇÃO</span>
                                <p style="margin: 0; font-size: 0.85rem; color: #fff;">Local + Pipeline</p>
                            </div>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>2. Instalação e Configuração</h3>
                        
                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">INSTALAÇÃO (WINDOWS)</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>PowerShell</span>
                                <button class="btn-copy" onclick="utils.copyCode('gitleaks-install-win')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="gitleaks-install-win"># Via Chocolatey
choco install gitleaks

# Verificar instalação
gitleaks version</code></pre>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">INSTALAÇÃO (LINUX/MAC)</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Bash</span>
                                <button class="btn-copy" onclick="utils.copyCode('gitleaks-install-linux')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="gitleaks-install-linux"># Via Homebrew
brew install gitleaks

# Ou via script de instalação
curl -sSfL https://raw.githubusercontent.com/gitleaks/gitleaks/master/scripts/install.sh | sh</code></pre>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>3. Execução Local (Pré-Commit)</h3>
                        
                        <div class="pro-tip">
                            <div class="pro-tip-header"><i class="ph ph-shield-check"></i> Boa Prática</div>
                            <p style="margin: 0; font-size: 0.9rem;">Execute o Gitleaks <strong>antes de cada commit</strong> para detectar credenciais vazadas antes de enviá-las ao repositório remoto.</p>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">SCAN COMPLETO DO REPOSITÓRIO</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Terminal</span>
                                <button class="btn-copy" onclick="utils.copyCode('gitleaks-scan')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="gitleaks-scan"># Escanear todo o repositório (histórico completo)
gitleaks detect --source . --verbose

# Escanear apenas arquivos staged (pré-commit)
gitleaks protect --staged --verbose

# Gerar relatório em JSON
gitleaks detect --source . --report-path gitleaks-report.json</code></pre>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">INTEGRAÇÃO COM GIT HOOKS</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>.git/hooks/pre-commit</span>
                                <button class="btn-copy" onclick="utils.copyCode('gitleaks-hook')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="gitleaks-hook">#!/bin/sh
# Pre-commit hook para Gitleaks

echo "Running Gitleaks..."
gitleaks protect --staged --verbose

if [ $? -eq 1 ]; then
    echo "⚠️  Gitleaks detectou credenciais! Commit bloqueado."
    exit 1
fi

echo "✅ Gitleaks: Nenhum secret detectado."
exit 0</code></pre>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>4. Integração CI/CD (Pipeline)</h3>
                        
                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">GITHUB ACTIONS</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>.github/workflows/gitleaks.yml</span>
                                <button class="btn-copy" onclick="utils.copyCode('gitleaks-github')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="gitleaks-github">name: Gitleaks

on: [push, pull_request]

jobs:
  gitleaks:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      
      - name: Run Gitleaks
        uses: gitleaks/gitleaks-action@v2
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}</code></pre>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">GITLAB CI</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>.gitlab-ci.yml</span>
                                <button class="btn-copy" onclick="utils.copyCode('gitleaks-gitlab')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="gitleaks-gitlab">gitleaks:
  stage: security
  image: zricethezav/gitleaks:latest
  script:
    - gitleaks detect --source . --verbose --report-path gitleaks-report.json
  artifacts:
    reports:
      junit: gitleaks-report.json
    when: always</code></pre>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>5. Tratamento de Falsos Positivos</h3>
                        
                        <p>Use o arquivo <code>.gitleaksignore</code> para suprimir falsos positivos específicos.</p>

                        <div class="code-block">
                            <div class="code-header">
                                <span>.gitleaksignore</span>
                                <button class="btn-copy" onclick="utils.copyCode('gitleaks-ignore')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="gitleaks-ignore"># Exemplos de hashes de commits ou arquivos a ignorar
# Hash do commit
abc123def456

# Arquivo específico
src/test/fixtures/fake-secrets.json

# Padrão de arquivo
**/test/fixtures/**</code></pre>
                        </div>

                        <div class="meta-card card-warning" style="margin-top: 30px;">
                            <span class="meta-label" style="color: var(--accent-gold);">ATENÇÃO</span>
                            <p style="margin: 0; font-size: 0.85rem; color: #fff;">Documente sempre a justificativa para ignorar um alerta no <code>.gitleaksignore</code>. Nunca ignore alertas sem validação de segurança.</p>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>6. Critérios de Severidade</h3>
                        
                        <div class="cvss-table">
                            <div class="cvss-row cvss-header">
                                <span class="col-label">TIPO DE SECRET</span>
                                <span class="col-label">AÇÃO IMEDIATA</span>
                                <span class="col-label" style="text-align: center;">WAIVER</span>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--status-critical); font-weight: 700;">API KEYS / TOKENS</span>
                                <span style="font-size: 0.9rem; color: #fff;">Revogar imediatamente e rotacionar.</span>
                                <div class="badge-full" style="border-color: var(--status-critical); color: var(--status-critical);">PROIBIDO</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--accent-gold); font-weight: 700;">SENHAS / CREDENCIAIS</span>
                                <span style="font-size: 0.9rem; color: #fff;">Alterar senha e validar acessos.</span>
                                <div class="badge-full" style="border-color: var(--accent-gold); color: var(--accent-gold);">RESTRITO</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--status-success); font-weight: 700;">EXEMPLOS DE TESTE</span>
                                <span style="font-size: 0.9rem; color: #fff;">Validar que não são credenciais reais.</span>
                                <div class="badge-full" style="border-color: var(--status-success); color: var(--status-success);">PERMITIDO</div>
                            </div>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>7. Resposta a Incidentes</h3>
                        
                        <div class="meta-card card-critical">
                            <span class="meta-label" style="color: var(--status-critical);">PROCEDIMENTO EM CASO DE DETECÇÃO</span>
                            <ol style="margin: 10px 0 0 20px; color: #fff; font-size: 0.9rem; line-height: 1.8;">
                                <li><strong>Revogar</strong> a credencial imediatamente no serviço de origem.</li>
                                <li><strong>Rotacionar</strong> gerando nova credencial e atualizando configurações.</li>
                                <li><strong>Reescrever histórico</strong> do Git (se aplicável) com <code>git filter-branch</code> ou BFG.</li>
                                <li><strong>Notificar</strong> a equipe de segurança via ticket/e-mail.</li>
                                <li><strong>Auditar</strong> logs de acesso para verificar uso indevido.</li>
                            </ol>
                        </div>
                    </section>
                </div>
            </div>

        </main>
    </div>

    <script src="js/utils.js"></script>
    <script src="js/calculators.js"></script>
    <script src="js/flow-logic.js"></script>
    <script src="js/navigation.js"></script>
</body>
</html>