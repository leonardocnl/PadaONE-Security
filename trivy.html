<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trivy - PADAONE Security</title>
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/BlackOL.png" media="(prefers-color-scheme: light)">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/WhiteOL.png" media="(prefers-color-scheme: dark)">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/BlackOL.png">    
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/flowcharts.css">
    <link rel="stylesheet" href="css/responsive.css">

    <script src="js/theme.js"></script>
</head>
<body>
    <div class="app-container">
        
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo-area">
                    <button style="background: none; border: none; cursor: pointer; padding: 0; display: flex; align-items: center;" onclick="nav.switchTool('dashboard')">
                        <img src="assets/images/PADAONE-Security Dark.png" alt="PADAONE Security" style="height: 80px; width: 100%; object-fit: contain;">
                        <img src="assets/images/PADAONE-Security Light.png" alt="PADAONE Security" style="height: 80px; width: 100%; object-fit: contain;">
                    </button>
                </div>
            </div>

            <nav>
                <div class="nav-group">
                    <div class="nav-title">Geral</div>
                    <div class="nav-item" onclick="nav.switchTool('dashboard')">
                        <i class="ph ph-squares-four"></i> Dashboard
                    </div>
                    <div class="nav-item" onclick="nav.switchTool('logic')">
                        <i class="ph ph-tree-structure"></i> Lógica de Bibliotecas
                    </div>
                </div>

                <div class="nav-group">
                    <div class="nav-title">Ferramentas</div>
                    <div class="nav-item active" onclick="nav.switchTool('trivy')">
                        <i class="ph ph-package"></i> Trivy (SCA)
                    </div>
                    <div class="nav-item" onclick="nav.switchTool('semgrep')">
                        <i class="ph ph-code"></i> Semgrep (SAST)
                    </div>
                    <div class="nav-item" onclick="nav.switchTool('gitleaks')">
                        <i class="ph ph-key"></i> Gitleaks (Secrets)
                    </div>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <header class="top-bar">
                <button class="menu-toggle" id="menuToggle" onclick="toggleMobileSidebar()">
                    <i class="ph ph-list"></i>
                </button>
                <button id="btn-back" class="back-btn" onclick="nav.goBack()">
                    <i class="ph ph-caret-left"></i>
                </button>
                <span id="breadcrumb" style="color: var(--text-muted); font-size: 0.9rem;">Trivy (SCA)</span>
                <button class="theme-toggle" aria-label="Alternar tema" title="Alternar tema">
                    <i class="ph ph-sun"></i>
                </button>
            </header>

            <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeMobileSidebar()"></div>

            <div class="tool-layout">
                <div class="scroll-area">
                    <div class="badge-group">
                        <span class="badge recommend">SCA</span>
                        <span class="badge">TRIVY</span>
                        <span class="badge">MANUAL V1.0</span>
                    </div>
                    <h1>Trivy - Software Composition Analysis</h1>
                    <p>O Trivy é a nossa principal ferramenta de visibilidade para a Supply Chain, identificando vulnerabilidades em dependências, imagens de container e infraestrutura como código (IaC).</p>

                    <section style="margin-bottom: 50px;">
                        <div class="pro-tip" style="border-left: 4px solid var(--accent-cyan); background: rgba(0, 255, 255, 0.05); padding: 20px;">
                            <div class="pro-tip-header" style="color: var(--accent-cyan); font-weight: bold; display: flex; align-items: center; gap: 10px;">
                                <i class="ph ph-detective" style="font-size: 1.5rem;"></i> TRIVY: O NOSSO DETETIVE
                            </div>
                            <p style="margin: 10px 0 0 0; font-size: 0.95rem; line-height: 1.6; color: var(--text-main);">
                                O Trivy atua como um <strong>investigador implacável</strong>: ele vasculha cada camada do projeto para encontrar o crime (vulnerabilidade). 
                                No entanto, ele apenas reporta os fatos. A sentença final — se vamos atualizar, ignorar ou mitigar — é ditada estritamente pela nossa 
                                <a href="#" onclick="nav.switchTool('logic'); return false;" style="color: var(--accent-cyan); font-weight: bold; text-decoration: underline;">Lógica de Bibliotecas</a>.
                            </p>
                        </div>
                    </section>

                    <section id="trivy-visao-geral" style="margin-bottom: 50px;">
                        <h3>1. Visão Geral</h3>
                        <div class="meta-grid" style="grid-template-columns: repeat(4, 1fr);">
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">TIPO</span>
                                <p style="margin: 0; font-size: 0.85rem; color: var(--text-main);">SCA + Container Scan</p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">LINGUAGENS</span>
                                <p style="margin: 0; font-size: 0.85rem; color: var(--text-main);">20+ (JS, Python, etc.)</p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">ALVOS</span>
                                <p style="margin: 0; font-size: 0.85rem; color: var(--text-main);">Code, Images, IaC</p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">EXECUÇÃO</span>
                                <p style="margin: 0; font-size: 0.85rem; color: var(--text-main);">Local + Pipeline</p>
                            </div>
                        </div>
                    </section>

                    <section id="trivy-instalacao" style="margin-bottom: 50px;">
                        <h3>2. Instalação e Configuração</h3>
                        
                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">INSTALAÇÃO (WINDOWS/LINUX)</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>PowerShell / Bash</span>
                                <button class="btn-copy" onclick="utils.copyCode('trivy-install')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="trivy-install"># Windows (Chocolatey)
choco install trivy

# Linux (Debian/Ubuntu)
sudo apt-get install trivy</code></pre>
                        </div>
                    </section>

                    <section id="trivy-comandos" style="margin-bottom: 50px;">
                        <h3>3. Comandos de Uso</h3>
                        
                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">ESCANEANDO DIRETÓRIOS E IMAGENS</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Terminal</span>
                                <button class="btn-copy" onclick="utils.copyCode('trivy-scan')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="trivy-scan"># Diretório atual (Filesystem)
trivy fs .

# Imagem Docker
trivy image nome-da-imagem:tag</code></pre>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">FILTRANDO VULNERABILIDADES</h4>
                        <div class="code-block">
                            <pre><code># Apenas bibliotecas de linguagem
trivy fs --scanners vuln --pkg-types library .

# Por nível de severidade (Alta e Crítica)
trivy fs --severity CRITICAL,HIGH .</code></pre>
                        </div>


                        <h4 style="color: var(--accent-cyan); margin: 30px 0 10px 0;">GERAR RELATÓRIO</h4>
                        <div class="code-block">
                            <pre><code>
trivy fs --format json --output evidencias.json
</code></pre>
                        </div>
                    </section>

                    <section id="trivy-trivyignore" style="margin-bottom: 50px;">
                        <h3>4. O Arquivo .trivyignore</h3>
                        <p>O arquivo <code>.trivyignore</code> serve para que o detetive ignore vulnerabilidades específicas que já foram analisadas e consideradas de baixo risco ou "falso positivo" pela equipe.</p>
                        
                        <div class="code-block">
                            <div class="code-header">
                                <span>.trivyignore</span>
                            </div>
                            <pre><code># CVE-2023-1234: Descrição do motivo
# Ignorar até que saia patch oficial (exp:2026-12-31)
CVE-2023-1234
CVE-2024-5678</code></pre>
                        </div>
                        <p style="font-size: 0.85rem; color: var(--text-muted);">* Toda entrada deve conter um comentário explicando o motivo da supressão.</p>
                    </section>
            
                    <section id="trivy-boas-praticas" style="margin-bottom: 50px;">
                        <h3>5. Boas Práticas</h3>
                        <div class="meta-card card-critical">
                            <span class="meta-label" style="color: var(--status-success);">CHECKLIST DO DETETIVE</span>
                            <ul style="margin: 10px 0 0 20px; color: var(--text-main); font-size: 0.9rem; line-height: 1.8;">
                                <li><strong>Pre-commit:</strong> Rode <code>trivy fs</code> antes de cada commit.</li>
                                <li><strong>Integridade:</strong> Mantenha o <code>.trivyignore</code> sempre atualizado e documentado.</li>
                                <li><strong>Decisão:</strong> O Trivy acha o erro, a <strong>Lógica de Biblioteca</strong> resolve o erro.</li>
                            </ul>
                        </div>
                    </section>
                </div>
            </div>
        </main>
    </div>

    <script>
        function toggleMobileSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (sidebar && overlay) {
                sidebar.classList.toggle('active');
                overlay.classList.toggle('active');
            }
        }
        function closeMobileSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (sidebar && overlay) {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
            }
        }
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) closeMobileSidebar();
        });

        const utils = {
            copyCode: function(id) {
                const code = document.getElementById(id);
                if (!code) return;
                navigator.clipboard.writeText(code.innerText);
                alert('Copiado!');
            }
        };
    </script>
</body>
</html>
                            <div class="cvss-row cvss-header">
                                <span class="col-label">SEVERIDADE</span>
                                <span class="col-label">AÇÃO IMEDIATA</span>
                                <span class="col-label" style="text-align: center;">WAIVER</span>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--status-critical); font-weight: 700;">CRITICAL (9.0+)</span>
                                <span style="font-size: 0.9rem; color: var(--text-main);">Bloqueio obrigatório. Escalonamento para Sênior.</span>
                                <div class="badge-full" style="border-color: var(--status-critical); color: var(--status-critical);">PROIBIDO</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--accent-gold); font-weight: 700;">HIGH (7.0-8.9)</span>
                                <span style="font-size: 0.9rem; color: var(--text-main);">Update obrigatório ou waiver justificado.</span>
                                <div class="badge-full" style="border-color: var(--accent-gold); color: var(--accent-gold);">RESTRITO</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--primary-blue); font-weight: 700;">MEDIUM (4.0-6.9)</span>
                                <span style="font-size: 0.9rem; color: var(--text-main);">Correção recomendada. Waiver se esforço > 16h.</span>
                                <div class="badge-full" style="border-color: var(--primary-blue); color: var(--primary-blue);">PERMITIDO</div>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--status-success); font-weight: 700;">LOW (0.1-3.9)</span>
                                <span style="font-size: 0.9rem; color: var(--text-main);">Monitorar. Correção não urgente.</span>
                                <div class="badge-full" style="border-color: var(--status-success); color: var(--status-success);">PERMITIDO</div>
                            </div>
                        </div>

                        <div class="pro-tip" style="margin-top: 30px;">
                            <div class="pro-tip-header"><i class="ph ph-link"></i> Lógica de Bibliotecas</div>
                            <p style="margin: 0; font-size: 0.9rem;">Para decisões detalhadas sobre como tratar vulnerabilidades, consulte a <a href="#" onclick="nav.switchTool('logic'); return false;" style="color: var(--accent-cyan); text-decoration: underline;">Lógica de Bibliotecas</a>.</p>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>8. Tipos de Scan Avançados</h3>
                        
                        <div class="meta-grid" style="grid-template-columns: 1fr 1fr;">
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">SBOM GENERATION</span>
                                <p style="margin: 5px 0 10px 0; font-size: 0.85rem; color: var(--text-main);">Gerar Software Bill of Materials</p>
                                <div class="code-block" style="margin: 0;">
                                    <pre style="padding: 15px;"><code>trivy sbom --format cyclonedx \
  --output sbom.json \
  myapp:latest</code></pre>
                                </div>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">IAC SCAN (TERRAFORM)</span>
                                <p style="margin: 5px 0 10px 0; font-size: 0.85rem; color: var(--text-main);">Scan de misconfigurations IaC</p>
                                <div class="code-block" style="margin: 0;">
                                    <pre style="padding: 15px;"><code>trivy config \
  --severity CRITICAL,HIGH \
  ./terraform/</code></pre>
                                </div>
                            </div>
                        </div>

                        <div class="meta-grid" style="grid-template-columns: 1fr 1fr; margin-top: 20px;">
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">KUBERNETES MANIFESTS</span>
                                <p style="margin: 5px 0 10px 0; font-size: 0.85rem; color: var(--text-main);">Scan de YAML do K8s</p>
                                <div class="code-block" style="margin: 0;">
                                    <pre style="padding: 15px;"><code>trivy config \
  --scanners misconfig \
  k8s/deployment.yaml</code></pre>
                                </div>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">ROOTFS SCAN</span>
                                <p style="margin: 5px 0 10px 0; font-size: 0.85rem; color: var(--text-main);">Scan de filesystem de container</p>
                                <div class="code-block" style="margin: 0;">
                                    <pre style="padding: 15px;"><code>trivy rootfs \
  --security-checks vuln \
  /path/to/rootfs</code></pre>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>9. Integração com deps.dev</h3>
                        
                        <p>O deps.dev do Google complementa o Trivy com análise de reachability e OpenSSF Scorecard.</p>

                        <div class="meta-grid" style="grid-template-columns: 1fr 1fr;">
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--primary-blue);">TRIVY</span>
                                <ul style="margin: 10px 0 0 20px; color: var(--text-main); font-size: 0.85rem; line-height: 1.6;">
                                    <li>Vulnerabilidades conhecidas (CVE)</li>
                                    <li>Scan de imagens Docker</li>
                                    <li>Automação CI/CD</li>
                                    <li>Offline-capable</li>
                                </ul>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">DEPS.DEV</span>
                                <ul style="margin: 10px 0 0 20px; color: var(--text-main); font-size: 0.85rem; line-height: 1.6;">
                                    <li>Análise de alcançabilidade</li>
                                    <li>OpenSSF Scorecard</li>
                                    <li>Grafo de dependências</li>
                                    <li>Web-based UI</li>
                                </ul>
                            </div>
                        </div>

                        <div class="pro-tip" style="margin-top: 30px;">
                            <div class="pro-tip-header"><i class="ph ph-arrows-merge"></i> Fluxo Recomendado</div>
                            <p style="margin: 0; font-size: 0.9rem;"><strong>1.</strong> Trivy (local/pipeline) detecta CVE → <strong>2.</strong> deps.dev valida se é exploitável → <strong>3.</strong> Lógica de Bibliotecas define ação.</p>
                        </div>
                    </section>

                    <section style="margin-bottom: 50px;">
                        <h3>10. Boas Práticas de Implementação</h3>
                        
                        <div class="meta-card card-critical">
                            <span class="meta-label" style="color: var(--status-success);">CHECKLIST TRIVY</span>
                            <ul style="margin: 10px 0 0 20px; color: var(--text-main); font-size: 0.9rem; line-height: 1.8;">
                                <li><strong>Local:</strong> Executar <code>trivy fs .</code> antes de commits com novas dependências.</li>
                                <li><strong>Pre-commit Hook:</strong> Bloquear commits com CRITICAL/HIGH vulnerabilities.</li>
                                <li><strong>Pipeline:</strong> Gate obrigatório no CI/CD com <code>--exit-code 1</code>.</li>
                                <li><strong>Imagens:</strong> Scan de todas as imagens antes de push para registry.</li>
                                <li><strong>Base Images:</strong> Preferir imagens slim/alpine com menos vulnerabilidades.</li>
                                <li><strong>DB Updates:</strong> Atualizar banco de vulnerabilidades diariamente.</li>
                                <li><strong>SARIF Upload:</strong> Integrar com GitHub/GitLab Security Dashboards.</li>
                                <li><strong>Waivers:</strong> Documentar todas as exceções no <code>.trivyignore</code> com justificativa.</li>
>>>>>>> bibliotecas
                            </ul>
                        </div>
                    </section>
                </div>

                <aside class="right-toc">
                    <div class="toc-header">Nesta Página</div>
                    <ul class="toc-list">
                        <li class="toc-item"><a href="#trivy-visao-geral">Visão Geral</a></li>
                        <li class="toc-item"><a href="#trivy-instalacao">Instalação e Configuração</a></li>
                        <li class="toc-item"><a href="#trivy-comandos">Comandos de Uso</a></li>
                        <li class="toc-item"><a href="#trivy-trivyignore">Arquivo .trivyignore</a></li>
                        <li class="toc-item"><a href="#trivy-boas-praticas">Boas Práticas</a></li>
                    </ul>
                </aside>
            </div>

        </main>
    </div>

    <script>
        function toggleMobileSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (sidebar && overlay) {
                sidebar.classList.toggle('active');
                overlay.classList.toggle('active');
            }
        }
        function closeMobileSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (sidebar && overlay) {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
            }
        }
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) closeMobileSidebar();
        });

        const utils = {
            copyCode: function(id) {
                const code = document.getElementById(id);
                if (!code) return;
                navigator.clipboard.writeText(code.innerText);
                alert('Copiado!');
            }
        };
    </script>
</body>
</html>


