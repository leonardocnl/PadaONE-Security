<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triagem de Bibliotecas - PADAONE Security</title>
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/BlackOL.png" media="(prefers-color-scheme: light)">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/WhiteOL.png" media="(prefers-color-scheme: dark)">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/BlackOL.png">
    
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/flowcharts.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <div class="app-container">
        
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo-area">
                    <button style="background: none; border: none; cursor: pointer; padding: 0; display: flex; align-items: center;" onclick="nav.switchTool('dashboard')">
                        <img src="assets/images/PADAONE-Security Dark.png" alt="PadaONE Security" style="height: 80px; width: 100%; object-fit: contain;">
                    </button>
                </div>
            </div>

            <nav>
                <div class="nav-group">
                    <div class="nav-title">Geral</div>
                    <div class="nav-item" onclick="nav.switchTool('dashboard')">
                        <i class="ph ph-squares-four"></i> Dashboard
                    </div>
                    <div class="nav-item active" onclick="nav.switchTool('logic')">
                        <i class="ph ph-tree-structure"></i> Triagem de Bibliotecas
                    </div>
                </div>

                <div class="nav-group">
                    <div class="nav-title">Ferramentas</div>
                    <div class="nav-item" onclick="nav.switchTool('trivy')">
                        <i class="ph ph-package"></i> Trivy (SCA)
                    </div>
                    <div class="nav-item" onclick="nav.switchTool('semgrep')">
                        <i class="ph ph-code"></i> Semgrep (SAST)
                    </div>
                    <div class="nav-item" onclick="nav.switchTool('gitleaks')">
                        <i class="ph ph-key"></i> Gitleaks (Secrets)
                    </div>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <header class="top-bar">
                <button class="menu-toggle" id="menuToggle" onclick="toggleMobileSidebar()">
                    <i class="ph ph-list"></i>
                </button>
                <button id="btn-back" class="back-btn" onclick="nav.goBack()">
                    <i class="ph ph-caret-left"></i>
                </button>
                <span id="breadcrumb" style="color: var(--text-muted); font-size: 0.9rem;">Triagem de Bibliotecas</span>
            </header>

            <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeMobileSidebar()"></div>

            <div class="tool-layout">
                <div class="scroll-area">
                    <div class="badge-group">
                        <span class="badge recommend">GOVERNANÇA</span>
                        <span class="badge">SCA</span>
                        <span class="badge">MANUAL V2.0</span>
                    </div>
                    <h1>Triagem de Bibliotecas</h1>
                    <p>Este manual fornece as diretrizes para que o desenvolvedor decida, de forma autônoma e fundamentada, entre a correção imediata de uma biblioteca, sua substituição por alternativas saudáveis ou o aceite temporário de riscos residuais. O objetivo central é proteger a Supply Chain contra vulnerabilidades herdadas [provenientes de dependências de terceiros] e minimizar o acúmulo de débito técnico.</p>

                    <section id="logic-quick" style="margin-bottom: 30px;">
                        <h3>1. Tabela de Decisão Rápida</h3>
                        <p>Filtro inicial ao identificar uma vulnerabilidade no Trivy ou deps.dev:</p>
                        
                        <div class="cvss-table" style="margin-bottom: 30px;">
                            <div class="cvss-row cvss-header" style="grid-template-columns: 180px 1fr 200px;">
                                <span class="col-label">CENÁRIO IDENTIFICADO</span>
                                <span class="col-label">CONDIÇÃO TÉCNICA</span>
                                <span class="col-label">AÇÃO OBRIGATÓRIA</span>
                            </div>
                            <div class="cvss-row" style="grid-template-columns: 180px 1fr 200px;">
                                <span style="color: var(--status-success); font-weight: 700;">Biblioteca Saudável</span>
                                <span style="font-size: 0.9rem; color: #fff;">Sem vulnerabilidades + manutenção ativa (últimos 12 meses)</span>
                                <div class="badge-full" style="border-color: var(--status-success); color: var(--status-success);">EXECUTAR TAREFA</div>
                            </div>
                            <div class="cvss-row" style="grid-template-columns: 180px 1fr 200px;">
                                <span style="color: var(--accent-gold); font-weight: 700;">Biblioteca Obsoleta</span>
                                <span style="font-size: 0.9rem; color: #fff;">Sem manutenção ativa (> 12 meses)</span>
                                <div class="badge-full" style="border-color: var(--accent-gold); color: var(--accent-gold);">BUSCAR ALTERNATIVA</div>
                            </div>
                            <div class="cvss-row" style="grid-template-columns: 180px 1fr 200px;">
                                <span style="color: var(--primary-blue); font-weight: 700;">Vulnerabilidade c/ Patch</span>
                                <span style="font-size: 0.9rem; color: #fff;">Existe correção oficial sem Breaking Changes</span>
                                <div class="badge-full" style="border-color: var(--primary-blue); color: var(--primary-blue);">UPDATE IMEDIATO</div>
                            </div>
                            <div class="cvss-row" style="grid-template-columns: 180px 1fr 200px;">
                                <span style="color: var(--status-critical); font-weight: 700;">Vulnerabilidade Crítica</span>
                                <span style="font-size: 0.9rem; color: #fff;">CVSS > 9.0 + função alcançável</span>
                                <div class="badge-full" style="border-color: var(--status-critical); color: var(--status-critical);">ESCALONAMENTO</div>
                            </div>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 15px 0;">Triagem Interativa</h4>
                        <p style="font-size: 0.9rem; margin-bottom: 20px;">Use a ferramenta abaixo para navegar passo a passo pela decisão:</p>
                        <div id="interactive-triage" style="background: var(--bg-panel); border: 1px solid var(--border-subtle); padding: 30px;">
                            <div id="triage-question" style="margin-bottom: 30px;">
                                <h5 style="color: var(--primary-blue); margin-bottom: 20px; font-size: 1rem; font-weight: 600;">A biblioteca possui vulnerabilidades conhecidas?</h5>
                                <div style="display: flex; gap: 12px;">
                                    <button class="triage-btn" onclick="triageFlow('vuln-yes')" style="flex: 1; padding: 12px 20px; background: transparent; border: 1px solid var(--border-subtle); color: #fff; font-weight: 500; cursor: pointer; transition: all 0.2s; font-size: 0.9rem;">SIM, possui vulnerabilidades</button>
                                    <button class="triage-btn" onclick="triageFlow('vuln-no')" style="flex: 1; padding: 12px 20px; background: transparent; border: 1px solid var(--border-subtle); color: #fff; font-weight: 500; cursor: pointer; transition: all 0.2s; font-size: 0.9rem;">NÃO, sem vulnerabilidades</button>
                                </div>
                            </div>
                            
                            <div id="triage-breadcrumb" style="display: none; padding: 15px; background: rgba(132, 94, 247, 0.05); border-left: 4px solid #845EF7; margin-bottom: 20px; font-size: 0.85rem; color: var(--text-muted);">
                                <strong style="color: #845EF7;">Caminho:</strong> <span id="breadcrumb-text"></span>
                            </div>
                            
                            <div id="triage-result" style="display: none; padding: 20px; border: 1px solid;">
                                <h5 style="color: var(--primary-blue); margin-bottom: 15px;">Resultado da Triagem</h5>
                                <p id="result-text" style="margin-bottom: 15px; font-size: 0.95rem; line-height: 1.6;"></p>
                                <button onclick="resetTriage()" style="padding: 10px 20px; background: var(--primary-blue); border: none; color: #fff; font-weight: 600; cursor: pointer;">Reiniciar Triagem</button>
                            </div>
                        </div>
                    </section>

                    <section id="logic-severity-vs-risk" style="margin-bottom: 30px;">
                        <h3>2. Diferenciação: Severidade vs. Risco</h3>
                        
                        <div style="background: rgba(220, 38, 38, 0.05); border-left: 4px solid var(--status-critical); padding: 15px; margin-bottom: 15px;">
                            <strong style="color: var(--status-critical);">SEVERIDADE</strong>
                            <p style="margin: 8px 0 0 0; font-size: 0.85rem; color: #fff; line-height: 1.6;">
                                <strong>Valor fixo</strong> do NVD ou deps.dev que indica o quão perigosa a falha é <strong>teoricamente</strong>. Independente do contexto de uso.
                            </p>
                        </div>
                        
                        <div style="background: rgba(245, 158, 11, 0.05); border-left: 4px solid var(--accent-gold); padding: 15px; margin-bottom: 15px;">
                            <strong style="color: var(--accent-gold);">RISCO (REAL)</strong>
                            <p style="margin: 8px 0 0 0; font-size: 0.85rem; color: #fff; line-height: 1.6;">
                                <strong>Valor variável</strong> confirmado apenas na <strong>Análise de Alcance</strong>. Uma vulnerabilidade HIGH só é risco se a função vulnerável for efetivamente importada no código.
                            </p>
                        </div>

                        <div style="background: rgba(132, 94, 247, 0.05); border-left: 4px solid #845EF7; padding: 20px; margin-top: 20px;">
                            <strong style="color: #845EF7;">✓ Exemplo Prático:</strong>
                            <p style="margin: 10px 0 0 0; font-size: 0.9rem; color: #fff;">Uma biblioteca tem CVE HIGH (7.5). Mas se a função vulnerável não for importada no seu código, o risco real é <strong>ZERO</strong>. Status: not_affected.</p>
                        </div>
                    </section>

                    <section id="logic-cvss" style="margin-bottom: 30px;">
                        <h3>3. Entenda a Métrica CVSS v4.0</h3>
                        <p>Sistema padrão de quantificação de severidade em escala de 0 a 10, dividido em 4 pilares:</p>
                        
                        <div class="meta-grid" style="grid-template-columns: repeat(2, 1fr); gap: 20px;">
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">MÉTRICAS DE BASE</span>
                                <p style="margin: 10px 0 0 0; font-size: 0.85rem; color: #fff;">Qualidades intrínsecas constantes ao longo do tempo e entre ambientes.</p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">MÉTRICAS DE AMEAÇA</span>
                                <p style="margin: 10px 0 0 0; font-size: 0.85rem; color: #fff;">Probabilidade de exploração com base em atividade real de exploits.</p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">MÉTRICAS AMBIENTAIS</span>
                                <p style="margin: 10px 0 0 0; font-size: 0.85rem; color: #fff;">Ajusta pontuação com base nos controles de segurança e implementação específica.</p>
                            </div>
                            <div class="meta-card">
                                <span class="meta-label" style="color: var(--accent-cyan);">MÉTRICAS SUPLEMENTARES</span>
                                <p style="margin: 10px 0 0 0; font-size: 0.85rem; color: #fff;">Atributos adicionais que não impactam a nota final, mas auxiliam a decisão.</p>
                            </div>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 15px 0;">STRING VETORIAL CVSS (QUANDO DISPONÍVEL)</h4>
                        <p style="font-size: 0.9rem; margin-bottom: 15px;">A String Vetorial CVSS é uma representação técnica das <strong>métricas de severidade</strong>. Quando disponível, deve ser incluída nas justificativas de Waiver para auditoria detalhada.</p>
                        
                        <div style="background: rgba(245, 158, 11, 0.05); border-left: 4px solid var(--accent-gold); padding: 15px; margin-bottom: 20px;">
                            <strong style="color: var(--accent-gold);">⚠️ ATENÇÃO:</strong>
                            <p style="margin: 8px 0 0 0; font-size: 0.85rem; color: #fff; line-height: 1.6;">
                                Nem todas as vulnerabilidades possuem String Vetorial, especialmente as mais antigas. Se não houver String Vetorial disponível, inclua no Waiver apenas o <strong>CVE/GHSA ID</strong> e o <strong>Score numérico</strong> (ex: CVE-2019-10744, Score: 9.1 CRITICAL).
                            </p>
                        </div>
                        
                        <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); padding: 20px; margin-bottom: 20px;">
                            <strong style="color: var(--primary-blue); font-size: 0.9rem;">ONDE PROCURAR A STRING VETORIAL:</strong>
                            <ul style="margin: 10px 0 0 20px; color: #fff; font-size: 0.85rem; line-height: 1.8;">
                                <li><strong>Trivy:</strong> Campo "CVSS Vector" na saída do relatório</li>
                                <li><strong>NVD (nvd.nist.gov):</strong> Página do CVE → seção "CVSS Metrics" → campo "Vector String"</li>
                                <li><strong>deps.dev:</strong> Clique no advisory → procure por "Vector" (nem sempre disponível)</li>
                                <li><strong>Se não encontrar:</strong> Use apenas o score numérico no Waiver</li>
                            </ul>
                        </div>

                        <p style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 10px;">Exemplo de String Vetorial (quando disponível):</p>
                        <div class="code-block">
                            <pre style="padding: 15px; margin: 0;"><code>CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</code></pre>
                        </div>

                        <div class="cvss-table" style="margin-top: 30px;">
                            <div class="cvss-row cvss-header" style="grid-template-columns: 160px 200px 1fr;">
                                <span class="col-label">PONTUAÇÃO</span>
                                <span class="col-label">RISCO INTRÍNSECO</span>
                                <span class="col-label">AÇÃO DE GOVERNANÇA</span>
                            </div>
                            <div class="cvss-row" style="grid-template-columns: 160px 200px 1fr;">
                                <span style="color: var(--status-success); font-weight: 700;">0.0 - 6.9</span>
                                <span style="font-size: 0.9rem; color: #fff;">Baixo</span>
                                <span style="font-size: 0.9rem; color: #fff;">Atualizar conforme ciclo ordinário.</span>
                            </div>
                            <div class="cvss-row" style="grid-template-columns: 160px 200px 1fr;">
                                <span style="color: var(--accent-gold); font-weight: 700;">7.0 - 8.9</span>
                                <span style="font-size: 0.9rem; color: #fff;">Alto</span>
                                <span style="font-size: 0.9rem; color: #fff;">Waiver exige busca obrigatória de alternativa (socket.dev).</span>
                            </div>
                            <div class="cvss-row" style="grid-template-columns: 160px 200px 1fr;">
                                <span style="color: var(--status-critical); font-weight: 700;">9.0 - 10.0</span>
                                <span style="font-size: 0.9rem; color: #fff;">Crítico</span>
                                <span style="font-size: 0.9rem; color: #fff;"><strong>Escalonamento Crítico OBRIGATÓRIO</strong> para Time de Segurança.</span>
                            </div>
                        </div>
                    </section>

                    <section id="logic-context" style="margin-bottom: 30px;">
                        <h3>4. Diferenciação de Contexto [Ambiente]</h3>
                        <p>O rigor da análise depende da natureza da dependência:</p>
                        
                        <div style="display: flex; gap: 20px; width: 100%;">
                            <div class="meta-card card-critical" style="flex: 1; padding: 15px; display: flex; flex-direction: column; justify-content: center;">
                                <span class="meta-label" style="color: var(--status-critical); font-size: 0.95rem; font-weight: 600;">DEPENDENCIES (PRODUÇÃO)</span>
                                <p style="margin: 0; font-size: 0.85rem; color: #fff; line-height: 1.5;">
                                    <strong>Contexto:</strong> Enviadas ao servidor/usuário final<br>
                                    <strong>Rigor Máximo:</strong> Score manutenção > 85 (socket.dev) + remediação imediata de vulnerabilidades.
                                </p>
                            </div>
                            <div class="meta-card card-warning" style="flex: 1; padding: 15px; display: flex; flex-direction: column; justify-content: center;">
                                <span class="meta-label" style="color: var(--accent-gold); font-size: 0.95rem; font-weight: 600;">DEVDEPENDENCIES (DESENVOLVIMENTO)</span>
                                <p style="margin: 0; font-size: 0.85rem; color: #fff; line-height: 1.5;">
                                    <strong>Contexto:</strong> Ferramentas de build/teste (Tailwind, Jest, etc.)<br>
                                    <strong>Proteção Supply Chain:</strong> Foco em prevenir comprometimento do ambiente de desenvolvimento.
                                </p>
                            </div>
                        </div>
                    </section>

                    <section id="logic-steps" style="margin-bottom: 30px;">
                        <h3>5. Fluxo de Decisão: Passo a Passo</h3>
                        
                        <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); padding: 20px; margin-bottom: 30px;">
                            <strong style="color: var(--primary-blue); font-size: 0.9rem;">SEGUIR ESTA SEQUÊNCIA:</strong>
                            <ol style="margin: 10px 0 0 20px; color: #fff; font-size: 0.9rem; line-height: 1.8;">
                                <li><strong>Consulta Saúde/Segurança</strong> no deps.dev</li>
                                <li><strong>Verificação de Patch</strong> sem Breaking Changes</li>
                                <li><strong>Análise de Alcance (Reachability)</strong> - função vulnerável é usada?</li>
                                <li><strong>Viabilidade de Alternativas</strong> no socket.dev (score > 85)</li>
                                <li><strong>Avaliação de Esforço</strong> (referência: 16 horas)</li>
                                <li><strong>Triagem de Severidade Final</strong> - define nível de governança</li>
                            </ol>
                        </div>
                    </section>

                    <section id="logic-waiver" style="margin-bottom: 30px;">
                        <h3>6. Gestão de Waivers: Templates Obrigatórios</h3>
                        <p>Toda biblioteca vulnerável mantida exige justificativa formal em Git e OpenProject com tag Segurança.</p>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 15px 0;">NO GIT (COMMIT MESSAGE)</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Template - Waiver Temporário</span>
                                <button class="btn-copy" onclick="utils.copyCode('waiver-git-temp')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="waiver-git-temp">Waiver de Segurança: [CVE-ID ou Obsolescência]

Justificativa: [Vulnerabilidade de baixo impacto / Custo de migração elevado / Falta de alternativa viável]
Status: Função não exposta ou isolada
Prazo de Reavaliação: Máximo 10 dias</code></pre>
                        </div>

                        <div class="code-block" style="margin-top: 20px;">
                            <div class="code-header">
                                <span>Template - Not Affected</span>
                                <button class="btn-copy" onclick="utils.copyCode('waiver-git-na')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="waiver-git-na">Waiver de Segurança: [CVE-ID]

Justificativa: Biblioteca mantida por ser inalcançável no contexto atual
Status: not_affected (Função não importada)
String Vetorial: [ex: CVSS:4.0/AV:N/...]
Registro obrigatório para checagem periódica
Prazo de Reavaliação: Máximo 10 dias</code></pre>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 15px 0;">NO OPENPROJECT (RASTREABILIDADE)</h4>
                        <div style="background: rgba(132, 94, 247, 0.05); border-left: 4px solid #845EF7; padding: 20px;">
                            <p style="margin: 0 0 15px 0; font-size: 0.9rem;"><strong>Criar Work Package com:</strong></p>
                            <ul style="margin: 0 0 0 20px; color: #fff; font-size: 0.85rem; line-height: 1.8;">
                                <li><strong>Tipo:</strong> Tarefa ou Bug</li>
                                <li><strong>Assunto:</strong> [WAIVER] - [NOME_BIBLIOTECA] - [CVE-ID]</li>
                                <li><strong>Descrição:</strong> Justificativa técnica + Análise de Alcance + Link commit Git</li>
                                <li><strong>Categoria:</strong> Adicionar "Segurança" e "Waiver"</li>
                                <li><strong>Prazo:</strong> Não superior a 10 dias</li>
                                <li><strong>Custom Field:</strong> Link para commit no Git</li>
                            </ul>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 15px 0;">TABELA DE CAMPOS WAIVER</h4>
                        <div class="cvss-table">
                            <div class="cvss-row cvss-header">
                                <span class="col-label">CAMPO</span>
                                <span class="col-label">CONTEÚDO OBRIGATÓRIO</span>
                                <span class="col-label">FINALIDADE</span>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--accent-cyan); font-weight: 700; font-size: 0.9rem;">Descrição</span>
                                <span style="font-size: 0.9rem; color: #fff;">Justificativa técnica + Análise de Alcance</span>
                                <span style="font-size: 0.9rem; color: #fff;">Justificar risco aceito</span>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--accent-cyan); font-weight: 700; font-size: 0.9rem;">Versão</span>
                                <span style="font-size: 0.9rem; color: #fff;">Versão atual da biblioteca vulnerável</span>
                                <span style="font-size: 0.9rem; color: #fff;">Controle de inventário</span>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--accent-cyan); font-weight: 700; font-size: 0.9rem;">Atribuído a</span>
                                <span style="font-size: 0.9rem; color: #fff;">Desenvolvedor responsável pela análise</span>
                                <span style="font-size: 0.9rem; color: #fff;">Responsabilidade técnica</span>
                            </div>
                            <div class="cvss-row">
                                <span style="color: var(--accent-cyan); font-weight: 700; font-size: 0.9rem;">Link Git</span>
                                <span style="font-size: 0.9rem; color: #fff;">URL do commit no repositório</span>
                                <span style="font-size: 0.9rem; color: #fff;">Rastreabilidade do código</span>
                            </div>
                        </div>
                    </section>

                    <section id="logic-escalation" style="margin-bottom: 30px;">
                        <h3>7. Escalonamento Crítico (CVSS > 9.0)</h3>
                        <p>Processo de trava de governança para riscos de alta severidade:</p>

                        <div class="meta-card card-critical" style="margin-bottom: 20px;">
                            <span class="meta-label" style="color: var(--status-critical);">GATILHO</span>
                            <p style="margin: 10px 0 0 0; font-size: 0.9rem; color: #fff;">Ativado quando severidade > 9.0 OU obsolescência afetar bibliotecas centrais.</p>
                        </div>

                        <h4 style="color: var(--accent-cyan); margin-bottom: 15px;">WORKFLOW OBRIGATÓRIO</h4>
                        <ol style="margin: 0 0 20px 20px; padding-left: 20px; color: #fff; font-size: 0.9rem; line-height: 1.8;">
                            <li>Alterar status no OpenProject para <strong>[Em Revisão]</strong></li>
                            <li>Aguardar revisão obrigatória do <strong>Time de Segurança</strong></li>
                            <li>Revisor valida: Análise de Alcance + Cálculo Esforço + Alternativas</li>
                            <li>Publicar comentário de aprovação conforme template</li>
                            <li>Waiver só é válido após aprovação do revisor</li>
                        </ol>

                        <h4 style="color: var(--accent-cyan); margin: 30px 0 15px 0;">TEMPLATE DE COMENTÁRIO DE APROVAÇÃO</h4>
                        <div class="code-block">
                            <div class="code-header">
                                <span>Revisor: Copiar e Preencher</span>
                                <button class="btn-copy" onclick="utils.copyCode('escalation-approval')"><i class="ph ph-copy"></i></button>
                            </div>
                            <pre><code id="escalation-approval">Parecer Técnico de Escalonamento Crítico

Validação de Alcance:
Confirmo que a análise de Reachability foi executada e a função 
vulnerável é de fato inativa ou isolada no contexto do projeto.
Detalhes: [descrever análise realizada]

Validação de Esforço:
O cálculo de esforço estimado em [X] horas foi auditado e considerado 
condizente com a complexidade técnica da remediação.
Detalhes: [refatoração, testes, etc.]

Análise de Alternativas:
Validei a inexistência de Alternativas Viáveis com paridade funcional 
imediata no socket.dev (score > 85).
Detalhes: [quais alternativas foram descartadas e por quê]

Decisão: ✅ APROVADO para uso temporário sob regime de Waiver
Prazo de Reavaliação: 10 dias
Revisor: [Nome] | Data: [Data]</code></pre>
                        </div>
                    </section>

                    <footer class="app-footer">
                        <p>© 2026 PadaONE Security · Todos os direitos reservados</p>
                    </footer>
                </div>

                <aside class="right-toc">
                    <div class="toc-header">Nesta Página</div>
                    <ul class="toc-list">
                        <li class="toc-item"><a href="#logic-quick">Decisão Rápida</a></li>
                        <li class="toc-item"><a href="#logic-severity-vs-risk">Severidade vs. Risco</a></li>
                        <li class="toc-item"><a href="#logic-cvss">Métrica CVSS v4.0</a></li>
                        <li class="toc-item"><a href="#logic-context">Contexto (Deps/DevDeps)</a></li>
                        <li class="toc-item"><a href="#logic-steps">Fluxo de Decisão</a></li>
                        <li class="toc-item"><a href="#logic-waiver">Templates Waiver</a></li>
                        <li class="toc-item"><a href="#logic-escalation">Escalonamento Crítico</a></li>
                    </ul>
                </aside>
            </div>

        </main>
    </div>

    <script>
        function toggleMobileSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (!sidebar || !overlay) return;
            
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        }

        function closeMobileSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (!sidebar || !overlay) return;
            
            sidebar.classList.remove('active');
            overlay.classList.remove('active');
        }

        document.addEventListener('DOMContentLoaded', function() {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', closeMobileSidebar);
            });
        });

        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                closeMobileSidebar();
            }
        });
    </script>

    <script src="js/flow-logic.js"></script>
    <script src="js/triage.js"></script>
</body>
</html>
